<VirtualHost *:443>

	ServerAdmin admin@example.com
	DocumentRoot /var/www/vhosts/toto/website
	
	ServerName toto.example.com
	ServerAlias titi.example.com

	<Directory /var/www/vhosts/toto/website >
		AllowOverride None
		Require all granted
	</Directory>

	<Directory /var/www/vhosts/toto/website/admins >
            Options indexes
            AllowOverride None
            #  Section d'authentification
            AuthType Basic
            AuthName "Authentication Required"
            AuthUserFile "/var/www/vhosts/toto/privates/htpasswd"
            AuthGroupFile "/var/www/vhosts/toto/privates/htgroup"
            Require group admins
	</Directory>

	<Directory /var/www/vhosts/toto/website/users>
            Options Indexes
            AllowOverride None
            #  Section d'authentification
            AuthType Basic
            AuthName "Authentication Required"
            AuthUserFile "/var/www/vhosts/toto/privates/htpasswd"
            AuthGroupFile "/var/www/vhosts/toto/privates/htgroup"
            Require valid-user
	</Directory>

	Rewriteengine on
	# Redirect match poru images :
	RedirectMatch "(.*)\.gif$" "http://%{HTTP_HOST}:8080/$1.png"

	# Mod_rewrite 
	RewriteRule "(.*)\.jpg$" "http://%{HTTP_HOST}:8080/$1.png" [NC,L]
	RewriteRule "(.*)\.JPG$" "http://%{HTTP_HOST}:8080/$1.png" [NC,L]
	RewriteRule "(.*)\.png$" "http://%{HTTP_HOST}:8080/$1.png" [NC,L]

	# Redirection de IE
	RewriteCond %{HTTP_USER_AGENT} "MSIE [6-8]" [NC]
	RewriteRule ^(.*)$ https://www.gnu.org/philosophy/free-sw.html [R=301,L]

	# Redirection de chrome
	RewriteCond %{HTTP_USER_AGENT} "chrome" [NC]
	RewriteRule ^(.*)$ https://www.gnu.org/philosophy/free-sw.html [R=301,L]

	Redirect /recherche http://lmgtfy.com/
	
	# ssl
        SSLEngine on
        SSLCertificateFile "/etc/apache2/ssl/toto_example_com.crt"
        SSLCertificateKeyFile "/etc/apache2/ssl/toto_example_com.key"
	

	ErrorLog /var/www/vhosts/toto/logs/error.log
	CustomLog /var/www/vhosts/toto/logs/access.log combined

</VirtualHost>

# vim: syntax=apache ts=4 sw=4 sts=4 sr noet
